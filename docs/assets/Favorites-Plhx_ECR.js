import{w as y,o as x,a as l,c,b as h,f as I,u as d,_ as F,m as C,n as k,i as w,j as B,h as A,r as m,l as T}from"./index-CHuRDALl.js";import{_ as j}from"./CardList-BR2B5oFr.js";const M={class:"space-y-6"},N={key:0,class:"flex flex-col items-center justify-center py-16 sm:py-24"},$={__name:"Favorites",setup(V){const a=m([]),o=m(!0),u=w("cartContext"),{cartItems:n,toggleCartItem:v}=u??{},f=async()=>{try{o.value=!0;const[e,t]=await Promise.all([B(),A()]),i=new Map(t.map(s=>[s.id,s]));a.value=e.map(s=>{const r=i.get(s.productId);return r?{...r,imageUrl:r.imageUrl||"",isFavorite:!0,favoriteId:s.id,isAdded:n?.value?.some(g=>g.id===r.id)??!1}:null}).filter(Boolean)}catch(e){console.error("Ошибка загрузки избранного:",e)}finally{o.value=!1}},p=e=>v?.(e),_=async e=>{try{await T(e.favoriteId),a.value=a.value.filter(t=>t.id!==e.id)}catch(t){console.error("Ошибка удаления из избранного:",t)}};return y(()=>n?.value??[],e=>{a.value=a.value.map(t=>({...t,isAdded:e.some(i=>i.id===t.id)}))},{deep:!0}),x(f),(e,t)=>(l(),c("div",M,[t[0]||(t[0]=h("h2",{class:"text-2xl sm:text-3xl font-bold animate-fade-in"},"Мои закладки",-1)),!o.value&&!a.value.length?(l(),c("div",N,[I(d(F),{title:"Закладок пока нет",descr:"Добавляйте товары в избранное — они появятся здесь","image-url":"heart.svg"})])):o.value?k("",!0):(l(),C(d(j),{key:1,items:a.value,onAddToFavorite:_,onAddToCart:p},null,8,["items"]))]))}};export{$ as default};
