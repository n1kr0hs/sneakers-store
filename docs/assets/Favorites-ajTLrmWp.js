import{u as p,w as g,o as y,a as n,c,b as h,f as F,g as d,_ as x,j as k,k as w,i as I,r as m}from"./index-CI2Dvnfl.js";import{u as A,_ as B}from"./favorites-DkWmT1zy.js";const C={class:"space-y-6"},S={key:0,class:"flex flex-col items-center justify-center py-16 sm:py-24"},V={__name:"Favorites",setup(T){const a=m([]),r=m(!0),o=p(),i=A(),u=async()=>{try{r.value=!0,await i.fetchFavorites();const e=await I(),t=new Map(e.map(s=>[s.id,s]));a.value=Array.from(i.favoriteIds).map(s=>{const l=t.get(s);return l?{...l,imageUrl:l.imageUrl||"",isFavorite:!0,favoriteId:i.getFavoriteId(s),isAdded:o.items.some(_=>_.id===l.id)}:null}).filter(Boolean)}catch(e){console.error("Ошибка загрузки избранного:",e)}finally{r.value=!1}},v=e=>{o.toggleCartItem(e)},f=async e=>{try{await i.removeFavorite(e.id),a.value=a.value.filter(t=>t.id!==e.id)}catch(t){console.error("Ошибка удаления из избранного:",t)}};return g(()=>o.items,()=>{a.value=a.value.map(e=>({...e,isAdded:o.items.some(t=>t.id===e.id)}))},{deep:!0}),y(u),(e,t)=>(n(),c("div",C,[t[0]||(t[0]=h("h2",{class:"text-2xl sm:text-3xl font-bold animate-fade-in"},"Мои закладки",-1)),!r.value&&!a.value.length?(n(),c("div",S,[F(d(x),{title:"Закладок пока нет",descr:"Добавляйте товары в избранное — они появятся здесь","image-url":"heart.svg"})])):r.value?w("",!0):(n(),k(d(B),{key:1,items:a.value,onAddToFavorite:f,onAddToCart:v},null,8,["items"]))]))}};export{V as default};
