import{a as d,c as v,b as r,l as u,t as m,m as f,n as h,d as p,F,p as x,q as y,j as w,s as k,u as _,r as g,x as b,y as C,z as A}from"./index-CI2Dvnfl.js";const S={class:"group relative flex flex-col h-full bg-white border border-slate-100 rounded-2xl sm:rounded-3xl p-5 sm:p-8 cursor-pointer transition-all duration-300 hover:-translate-y-2 hover:shadow-xl hover:border-lime-200"},B=["src"],T=["src","alt"],$={class:"mt-3 text-sm sm:text-base flex-1"},j={class:"flex justify-between items-end mt-4 sm:mt-5"},z={class:"flex flex-col"},D={class:"font-bold text-sm sm:text-base"},L=["src"],M={__name:"CardListItem",props:{id:Number,imageUrl:String,title:String,price:Number,isFavorite:Boolean,isAdded:Boolean,onClickFavorite:{type:Function,default:null},onClickAdd:{type:Function,default:null}},setup(t){const o=t,l=f(()=>h(o.price));return(c,i)=>(d(),v("div",S,[r("img",{src:t.isFavorite?"like-2.svg":"like-1.svg",onClick:i[0]||(i[0]=u(n=>t.onClickFavorite?.(),["stop"])),alt:"В избранное",class:"absolute top-4 left-4 select-none sm:top-6 sm:left-6 w-8 h-8 opacity-80 hover:opacity-100 transition-opacity z-10"},null,8,B),r("img",{src:t.imageUrl,alt:t.title,class:"relative z-0 w-full h-40 select-none sm:h-48 object-contain transition-transform duration-300 group-hover:scale-105"},null,8,T),r("p",$,m(t.title),1),r("div",j,[r("div",z,[i[2]||(i[2]=r("span",{class:"text-slate-400 text-xs sm:text-sm"},"Цена:",-1)),r("span",D,m(l.value)+" руб.",1)]),r("img",{src:t.isAdded?"checked.svg":"plus.svg",onClick:i[1]||(i[1]=u(n=>t.onClickAdd?.(),["stop"])),alt:"Добавить в корзину",class:"w-8 h-8 opacity-70 select-none hover:opacity-100 transition-opacity"},null,8,L)])]))}},N={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-5 animate-stagger"},V={__name:"CardList",props:{items:Array},emits:["addToFavorite","addToCart"],setup(t,{emit:o}){const l=o;return(c,i)=>{const n=y("auto-animate");return p((d(),v("div",N,[(d(!0),v(F,null,x(t.items,a=>(d(),w(M,{key:a.id,id:a.id,title:a.title,"image-url":a.imageUrl,price:a.price,"is-favorite":a.isFavorite,"is-added":a.isAdded,"on-click-favorite":()=>l("addToFavorite",a),"on-click-add":()=>l("addToCart",a)},null,8,["id","title","image-url","price","is-favorite","is-added","on-click-favorite","on-click-add"]))),128))])),[[n]])}}},G=k("favorites",()=>{const t=g(new Set),o=g(new Map),l=_(),c=e=>t.value.has(e),i=e=>o.value.get(e),n=async e=>{try{const s=await b(e);return t.value.add(e),o.value.set(e,s.id),s}catch(s){throw console.error("Ошибка добавления в избранное:",s),s}},a=async e=>{try{const s=o.value.get(e);s&&(await C(s),t.value.delete(e),o.value.delete(e))}catch(s){throw console.error("Ошибка удаления из избранного:",s),s}};return{favoriteIds:t,favoriteMap:o,isFavorite:c,getFavoriteId:i,addFavorite:n,removeFavorite:a,toggleFavorite:async e=>{c(e)?await a(e):await n(e)},fetchFavorites:async()=>{try{const e=await A();t.value.clear(),o.value.clear(),e.forEach(s=>{t.value.add(s.productId),o.value.set(s.productId,s.id)})}catch(e){throw console.error("Ошибка загрузки избранного:",e),e}},isAddedToCart:e=>l.items.some(s=>s.id===e)}});export{V as _,G as u};
