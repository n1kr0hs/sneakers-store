import{w as _,o as g,a as i,c,b as h,f as x,u as n,_ as y,m as I,i as F,h as k,g as w,j as B,l as C}from"./index-DWsXD6TO.js";import{_ as A}from"./CardList-rB9ISxEF.js";const T={class:"space-y-6"},U={key:0,class:"flex flex-col items-center justify-center py-16 sm:py-24"},b={__name:"Favorites",setup(j){const a=B([]),d=F("cartContext"),{cartItems:l,toggleCartItem:m}=d??{},u=async()=>{try{const[e,t]=await Promise.all([k(),w()]),o=new Map(t.map(r=>[r.id,r]));a.value=e.map(r=>{const s=o.get(r.productId);return s?{...s,imageUrl:s.imageUrl?.startsWith("/")?s.imageUrl:`/${s.imageUrl}`,isFavorite:!0,favoriteId:r.id,isAdded:l?.value?.some(p=>p.id===s.id)??!1}:null}).filter(Boolean)}catch(e){console.error("Ошибка загрузки избранного:",e)}},v=e=>m?.(e),f=async e=>{try{await C(e.favoriteId),a.value=a.value.filter(t=>t.id!==e.id)}catch(t){console.error("Ошибка удаления из избранного:",t)}};return _(()=>l?.value??[],e=>{a.value=a.value.map(t=>({...t,isAdded:e.some(o=>o.id===t.id)}))},{deep:!0}),g(u),(e,t)=>(i(),c("div",T,[t[0]||(t[0]=h("h2",{class:"text-2xl sm:text-3xl font-bold animate-fade-in"}," Мои закладки ",-1)),a.value.length?(i(),I(n(A),{key:1,items:a.value,onAddToFavorite:f,onAddToCart:v},null,8,["items"])):(i(),c("div",U,[x(n(y),{title:"Закладок пока нет",descr:"Добавляйте товары в избранное — они появятся здесь","image-url":"/heart.svg"})]))]))}};export{b as default};
