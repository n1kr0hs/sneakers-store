import{w as _,o as g,a as i,c as l,b as x,f as y,u as n,_ as h,m as I,i as F,j as k,h as w,r as B,l as C}from"./index-3RQkWAKF.js";import{_ as A}from"./CardList-BcWEOSpJ.js";const T={class:"space-y-6"},j={key:0,class:"flex flex-col items-center justify-center py-16 sm:py-24"},U={__name:"Favorites",setup(M){const a=B([]),d=F("cartContext"),{cartItems:c,toggleCartItem:m}=d??{},u=async()=>{try{const[e,t]=await Promise.all([k(),w()]),r=new Map(t.map(s=>[s.id,s]));a.value=e.map(s=>{const o=r.get(s.productId);return o?{...o,imageUrl:o.imageUrl||"",isFavorite:!0,favoriteId:s.id,isAdded:c?.value?.some(p=>p.id===o.id)??!1}:null}).filter(Boolean)}catch(e){console.error("Ошибка загрузки избранного:",e)}},v=e=>m?.(e),f=async e=>{try{await C(e.favoriteId),a.value=a.value.filter(t=>t.id!==e.id)}catch(t){console.error("Ошибка удаления из избранного:",t)}};return _(()=>c?.value??[],e=>{a.value=a.value.map(t=>({...t,isAdded:e.some(r=>r.id===t.id)}))},{deep:!0}),g(u),(e,t)=>(i(),l("div",T,[t[0]||(t[0]=x("h2",{class:"text-2xl sm:text-3xl font-bold animate-fade-in"},"Мои закладки",-1)),a.value.length?(i(),I(n(A),{key:1,items:a.value,onAddToFavorite:f,onAddToCart:v},null,8,["items"])):(i(),l("div",j,[y(n(h),{title:"Закладок пока нет",descr:"Добавляйте товары в избранное — они появятся здесь","image-url":"heart.svg"})]))]))}};export{U as default};
